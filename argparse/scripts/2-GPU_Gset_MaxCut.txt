#!/bin/bash

#SBATCH --account DD-23-97
#SBATCH --partition qgpu
#SBATCH --time 2-00:00:00
#SBATCH --nodes=1
#SBATCH --gpus-per-node 2
#SBATCH --tasks-per-node=1
#SBATCH -J Gset
#SBATCH -o Gset_logfile.out
#SBATCH -e Gset_logfile.err
#SBATCH --mail-type=BEGIN,ABORT,END
#SBATCH --mail-user=sebastian.sanokowski@jku.at


source activate rayjay_clone
cd ~/code/DiffUCO/
conda activate rayjay_clone

nvidia-smi

# run script
python argparse_ray_main.py --lrs 0.0002 --relaxed --GPUs 0 1 --n_GNN_layers 5 --temps 1.2 --IsingMode Gset --EnergyFunction MaxCut --mode Diffusion --N_anneal 500 --beta_factor 1. --n_diffusion_steps 9 --batch_size 30 --n_basis_states 8 --noise_potential bernoulli --multi_gpu --project_name diff_steps_ --n_rand_nodes 0 --seed 123 --graph_mode normal --train_mode PPO --inner_loop_steps 1 --diff_schedule exp --minib_diff_steps 3 